!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.scour=t()}}(function(){return function t(n,e,r){function i(u,f){if(!e[u]){if(!n[u]){var a="function"==typeof require&&require;if(!f&&a)return a(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var c=e[u]={exports:{}};n[u][0].call(c.exports,function(t){var e=n[u][1][t];return i(e?e:t)},c,c.exports,t,n,e,r)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,n){"use strict";var e=t("../utilities/map");n.exports=function(t,n){var r=t.length?t.join(".")+".":"";return e(n,function(t,n){return n=(r+n).replace(/\./g,"\\.").replace(/\*\*/g,"::all::").replace(/\*/g,"::any::").replace(/::all::/g,".*").replace(/::any::/g,"[^.]+"),n=new RegExp("^"+n+"$"),[n,t]})}},{"../utilities/map":14}],2:[function(t,n){"use strict";n.exports=function(t){return function(){return!t.apply(this,arguments)}}},{}],3:[function(t,n){"use strict";n.exports=function(t,n){return"string"==typeof t?t.split("."):n&&1===t.length?Array.isArray(t[0])?t[0].map(function(t){return""+t}):"number"==typeof t[0]?[""+t[0]]:(""+t[0]).split("."):(n&&(t=[].slice.call(t)),t.map(function(t){return""+t}))}},{}],4:[function(t,n){"use strict";function e(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;n.exports=Object.assign||function(t){for(var n,o,u=e(t),f=1;f<arguments.length;f++){n=Object(arguments[f]);for(var a in n)r.call(n,a)&&(u[a]=n[a]);if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(n);for(var s=0;s<o.length;s++)i.call(n,o[s])&&(u[o[s]]=n[o[s]])}}return u}},{}],5:[function(t,n){!function(){"use strict";function t(t){return"function"==typeof t}function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t){return t instanceof Date?t.getTime():t instanceof Array?t.map(r):t}function i(t){return function(n,r){if(!e(r)||!r.length)return t(n,r);for(var i=0,o=r.length;o>i;i++)if(t(n,r[i]))return!0;return!1}}function o(t){return function(n,r){if(!e(r)||!r.length)return t(n,r);for(var i=0,o=r.length;o>i;i++)if(!t(n,r[i]))return!1;return!0}}function u(t,n){return t.v(t.a,n)}function f(t,n){for(var e=0;e<t.length;e++)if(u(n,t[e]))return e;return-1}function a(t,n){return{a:t,v:n}}function s(t,n){var e=[];return c(n,t.k,0,e),1===e.length?u(t.nv,e[0]):!!~f(e,t.nv)}function c(t,n,r,i){if(r===n.length||void 0==t)return void i.push(t);if(e(t))for(var o=0,u=t.length;u>o;o++)c(t[o],n,r,i);else c(t[n[r]],n,r+1,i)}function l(t,n){return{a:{k:t,nv:n},v:s}}function h(t){t=r(t),(!t||"Object"!==t.constructor.toString()&&"functionObject(){[nativecode]}"!==t.constructor.toString().replace(/\n/g,"").replace(/ /g,""))&&(t={$eq:t});var n=[];for(var e in t){var i=t[e];if("$options"!==e)if(d[e])g[e]&&(i=g[e](i,t)),n.push(a(r(i),d[e]));else{if(36===e.charCodeAt(0))throw new Error("Unknown operation "+e);n.push(l(e.split("."),h(i)))}}return 1===n.length?n[0]:a(n,d.$and)}function p(t,n){var e=h(t);return n&&(e={a:e,v:function(t,e){return u(t,n(e))}}),e}function y(n,e,r){function i(t){return u(o,t)}t(e)&&(r=e,e=void 0);var o=p(n,r);return e?Array.isArray(e)?e.filter(i):v(e,i):i}function v(t,n){var e={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n(i)&&(e[r]=i)}return e}var d={$eq:i(function(t,n){return t(n)}),$ne:o(function(t,n){return!t(n)}),$or:function(t,n){for(var e=0,r=t.length;r>e;e++)if(u(t[e],n))return!0;return!1},$gt:i(function(t,n){return typeof r(n)==typeof t&&r(n)>t}),$gte:i(function(t,n){return typeof r(n)==typeof t&&r(n)>=t}),$lt:i(function(t,n){return typeof r(n)==typeof t&&r(n)<t}),$lte:i(function(t,n){return typeof r(n)==typeof t&&r(n)<=t}),$mod:i(function(t,n){return n%t[0]==t[1]}),$in:function(t,n){if(!(n instanceof Array))return!!~t.indexOf(r(n));for(var e=n.length;e--;)if(~t.indexOf(r(n[e])))return!0;return!1},$nin:function(t,n){return!d.$in(t,n)},$not:function(t,n){return!u(t,n)},$type:function(t,n){return void 0!=n?n instanceof t||n.constructor==t:!1},$all:function(t,n){n||(n=[]);for(var e=t.length;e--;)if(!~r(n).indexOf(t[e]))return!1;return!0},$size:function(t,n){return n?t===n.length:!1},$nor:function(t,n){for(var e=0,r=t.length;r>e;e++)if(u(t[e],n))return!1;return!0},$and:function(t,n){for(var e=0,r=t.length;r>e;e++)if(!u(t[e],n))return!1;return!0},$regex:i(function(t,n){return"string"==typeof n&&t.test(n)}),$where:function(t,n){return t.call(n,n)},$elemMatch:function(t,n){return e(n)?!!~f(n,t):u(t,n)},$exists:function(t,n){return void 0!=n===t}},g={$eq:function(t){return t instanceof RegExp?function(n){return"string"==typeof n&&t.test(n)}:t instanceof Function?t:e(t)&&!t.length?function(t){return e(t)&&!t.length}:null===t?function(t){return null==t}:function(n){return t===r(n)}},$ne:function(t){return g.$eq(t)},$and:function(t){return t.map(h)},$or:function(t){return t.map(h)},$nor:function(t){return t.map(h)},$not:function(t){return h(t)},$regex:function(t,n){return new RegExp(t,n.$options)},$where:function(t){return"string"==typeof t?new Function("obj","return "+t):t},$elemMatch:function(t){return h(t)},$exists:function(t){return!!t}};y.use=function(n){if(t(n))return n(y);for(var e in n)36===e.charCodeAt(0)&&(d[e]=n[e])},y.indexOf=function(t,n,e){return f(n,p(t,e))},y.keyOf=function(t,n,e){var r=p(t,e);for(var i in n)if(n.hasOwnProperty(i)&&u(r,n[i]))return i},"undefined"!=typeof n&&"undefined"!=typeof n.exports&&(n.exports=y),"undefined"!=typeof window&&(window.sift=y)}()},{}],6:[function(t,n){"use strict";function e(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function r(t,n){return this instanceof r?(this.value=t,this.root=n&&n.root||this,this.keypath=n&&n.keypath||[],this.extensions=n&&n.extensions||[],void(this.extensions.length&&this.applyExtensions())):new r(t,n)}function i(t){return function(){return t.bind(null,this.forEach.bind(this)).apply(this,arguments)}}var o=t("sift"),u=t("object-assign"),f=t("./lib/build_extensions"),a=t("./lib/normalize_keypath"),s=t("./utilities"),c=t("./lib/negate");r.prototype={go:function(){var t=a(arguments,!0),n=this.get.apply(this,t);return this._get(n,t,!0)},gather:function(t){var n,e=this;return n=Array.isArray(this.values)?t.map(function(t,n){return[n,e.get(t)]}):s.indexedMap(t,function(t){return[t,e.get(t)]}),this.replace(n)},at:function(t){if(Array.isArray(this.value))return this._get(this.value[t],[""+t]);var n=this.keys()[t];return this._get(this.value[n],[""+n])},filter:function(t){return"function"==typeof t?this.filterByFunction(t):this.replace(o(t,this.value))},filterByFunction:function(t){var n,e=Array.isArray(this.value);return e?(n=[],this.each(function(e,r){return t(e,r)&&n.push(e.value)})):(n={},this.each(function(e,r){t(e,r)&&(n[r]=e.value)})),this.replace(n)},reject:function(t){return"function"==typeof t?this.filterByFunction(c(t)):this.filter({$not:t})},find:function(t){var n=o.keyOf(t,this.value);if("undefined"!=typeof n)return this._get(this.value[n],[n])},first:function(){return this.at(0)},last:function(){var t=this.len();return t>0?this.at(t-1):void 0},sortBy:function(t){var n;if("string"==typeof t){var e=t;t=function(t){return t[e]},n=s.map(this.value,function(n,e,r){return{key:e,value:n,criteria:t(n,e),index:r}})}else n=this.map(function(n,e,r){return{key:e,value:n.value,criteria:t(n,e),index:r}});var r=n.sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(r>e||void 0===r)return-1}return e.index-r.index});return this.replace(Array.isArray(this.value)?r.map(function(t){return t.value}):s.indexedMap(r,function(t){return[t.key,t.value]}))},get:function(){for(var t=this.value,n=a(arguments,!0),e=0,r=n.length;r>e;e++)if(t=t[n[e]],!t)return;return t},len:function(){return this.value?Array.isArray(this.value)?this.value.length:this.keys().length:0},toArray:function(){return Array.isArray(this.value)?this.value:r.map(this.value,function(t){return t})},values:function(){return this.toArray()},keys:function(){return Object.keys(this.value)},set:function(t,n){if(t=a(t),this.root!==this)return this.root.set(this.keypath.concat(t),n).go(this.keypath);var e=r.set(this.value,t,n.valueOf());return this.replace(e,{root:null})},del:function(t){if(t=a(t),this.root!==this)return this.root.del(this.keypath.concat(t)).go(this.keypath);var n=r.del(this.value,t);return this.replace(n,{root:null})},extend:function(){if("object"===e(this.value)&&!Array.isArray(this.value)){var t={};u(t,this.value);for(var n=0,r=arguments.length;r>n;n++){if("object"!==e(arguments[n]))return;u(t,arguments[n])}return this.root!==this?this.root.set(this.keypath,t).go(this.keypath):this.replace(t)}},use:function(t){var n=f(this.keypath,t);return this.root===this?this.replace(this.value,{extensions:n,root:null}):this.root.replace(this.root.value,{extensions:n,root:null}).replace(this.value,{keypath:this.keypath})},toJSON:function(){return this.value},valueOf:function(){return this.value},toString:function(){return"[scour ("+this.keys().join(", ")+")]"},forEach:function(t){var n=this,e=0;return r.each(this.value,function(r,i){t.call(r,n._get(r,[i]),i,e++)}),this},each:function(t){return this.forEach(t)},map:i(s.map),mapObject:i(s.mapObject),indexedMap:i(s.indexedMap),_get:function(t,n){return"undefined"==typeof t||null===t?t:this.replace(t,{keypath:this.keypath.concat(n)})},replace:function(t,n){var e=n||{};return new r(t||this.value,{root:"undefined"!=typeof e.root?e.root:this.root,keypath:"undefined"!=typeof e.keypath?e.keypath:this.keypath,extensions:"undefined"!=typeof e.extensions?this.extensions.concat(e.extensions):this.extensions})},applyExtensions:function(){var t=this,n=this.keypath.join(".");this.extensions.forEach(function(e){e[0].test(n)&&u(t,e[1])})}},u(r,s),n.exports=r},{"./lib/build_extensions":1,"./lib/negate":2,"./lib/normalize_keypath":3,"./utilities":12,"object-assign":4,sift:5}],7:[function(t,n){"use strict";n.exports=function(n){var e=t("object-assign");return Array.isArray(n)?[].slice.call(n):e({},n)}},{"object-assign":4}],8:[function(t,n){"use strict";n.exports=function(t,n){if(Array.isArray(t))return t.slice(0,+n).concat(t.slice(+n+1));var e={};n=""+n;for(var r in t)t.hasOwnProperty(r)&&n!==r&&(e[r]=t[r]);return e}},{}],9:[function(t,n){"use strict";function e(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var r=t("./clone"),i=t("./clone_without");n.exports=function(t,n){for(var o={},u={},f=0,a=n.length;a>f;f++)if(0===f)u[f]=t;else if(u[f]=u[f-1][n[f-1]],!u[f]||"object"!==e(u[f]))return t;for(var f=n.length-1;f>=0;f--)f===n.length-1?(o[f]=i(u[f],n[f]),delete o[f][n[f]]):(o[f]=r(u[f]),o[f][n[f]]=o[f+1]);return o[0]}},{"./clone":7,"./clone_without":8}],10:[function(t,n){"use strict";function e(t,n){if(t){var e,i,o=t.length;if("number"==typeof o){if(r)return r.call(t,n);for(e=0;o>e;e++)n(t[e],e,e)}else{i=0;for(e in t)t.hasOwnProperty(e)&&n(t[e],e,i++)}return t}}var r=Array.prototype.forEach;n.exports=e},{}],11:[function(t,n){"use strict";var e=t("./each");n.exports=function(t,n,r){var i,o="undefined"!=typeof r?r:Array.isArray(t);return"function"!=typeof t&&(t=e.bind(this,t)),o?(i=[],t(function(t){n.apply(this,arguments)&&i.push(t)})):(i={},t(function(t,e){n.apply(this,arguments)&&(i[e]=t)})),i}},{"./each":10}],12:[function(t,n,e){"use strict";e.set=t("./set"),e.del=t("./del"),e.each=t("./each"),e.map=t("./map"),e.mapObject=t("./map_object"),e.indexedMap=t("./indexed_map"),e.filter=t("./filter")},{"./del":9,"./each":10,"./filter":11,"./indexed_map":13,"./map":14,"./map_object":15,"./set":16}],13:[function(t,n){"use strict";var e=t("./each");n.exports=function(t,n){"function"!=typeof t&&(t=e.bind(this,t));var r={};return t(function(){var t=n.apply(this,arguments);r[t[0]]=t[1]}),r}},{"./each":10}],14:[function(t,n){"use strict";var e=t("./each");n.exports=function(t,n){"function"!=typeof t&&(t=e.bind(this,t));var r=[];return t(function(){r.push(n.apply(this,arguments))}),r}},{"./each":10}],15:[function(t,n){"use strict";var e=t("./each");n.exports=function(t,n){"function"!=typeof t&&(t=e.bind(this,t));var r={};return t(function(t,e){r[e]=n.apply(this,arguments)}),r}},{"./each":10}],16:[function(t,n){"use strict";function e(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var r=t("./clone");n.exports=function(t,n,i){for(var o={},u={},f=0,a=n.length;a>f;f++)0===f?u[f]=t:(u[f]=u[f-1][n[f-1]]||{},"object"!==e(u[f])&&(u[f]={}));for(var f=n.length;f>=0;f--)u[f]?(o[f]=r(u[f]),o[f][n[f]]=o[f+1]):o[f]=i;return o[0]}},{"./clone":7}]},{},[6])(6)});